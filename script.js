const products = {
    men: [       
        { image:"men/img1.webp", name: "Men Regular Fit Self Design Button Down Collar Casual Shirt", price:499},
        { image:"men/img2.webp", name: "Men Regular Fit Printed Spread Collar Casual Shirt", price:250},
        { image:"men/img3.webp", name: "Men Solid Round Neck Polyester White T-Shirt", price:229},
        { image:"men/img4.webp", name: "Men Full Sleeve Solid Hooded Sweatshirt", price:600},
        { image:"men/img5.webp", name: "Men Regular Fit White Spread Collar Casual Shirt", price:450},
        { image:"men/img6.webp", name: "Men Regular Fit Printed Spread Collar Casual Shirt", price:300},
        { image:"men/img7.webp", name: "Men Regular Fit Solid Spread Collar Formal Shirt", price:899},
        { image:"men/img8.webp", name: "Oversized Men Printed Pure Cotton White, Black T-Shirt", price:799},
        { image:"men/img9.webp", name: "Men Solid Polo Neck Polyester Pink T-Shirt", price:399},
        { image:"men/img10.webp", name: "Men Full Sleeve Solid Hooded Sweatshirt", price:899},
        { image:"men/img11.webp", name: "Men Solid Round Neck Cotton Blend T-shirt Men", price:250},
        { image:"men/img12.webp", name: "Men Full Sleeve Solid Hooded Sweatshirt", price:500},
        { image:"men/img13.webp", name: "Men Cotton Blend Kurta Pyjama Set", price:1099},
        { image:"men/img14.webp", name: "Heavy Jacquard Printed Sherwani", price:1299},
        { image:"men/img15.webp", name: "AMZIRA Self Design Sherwani", price:1500},
        { image:"men/img16.webp", name: "Men Regular Fit Printed Casual Shirt", price:250}
    ],

    women: [
        { image:"women/img1.webp", name: "Women Fit and Flare Black, Beige, Red Dress", price:799},
        { image:"women/img2.webp", name: "Women Tiered Yellow, Light Green Dress", price:499},
        { image:"women/img3.webp", name: "Embroidered Kurta, Trouser/Pant & Dupatta Set", price:899},
        { image:"women/img4.webp", name: "Plain Daily Wear Georgette, Chiffon Saree (Yellow)", price:999},
        { image:"women/img5.webp", name: "Woven Banarasi Cotton Silk Saree (Purple)", price:1299},
        { image:"women/img6.webp", name: "Women Embroidered Viscose Rayon Straight Kurta (White)", price:599},
        { image:"women/img7.webp", name: "Women Full Solid Flared Skirt (Light Green)", price:500},
        { image:"women/img8.webp", name: "Westhood Top Pant Co-ords Set with Blazer", price:1200},
        { image:"women/img9.webp", name: "Women Regular Fit Printed Spread Collar Casual Shirt", price:350},
        { image:"women/img10.webp", name: "Women Regular Fit Washed Cut Away Collar Casual Shirt", price:250},
        { image:"women/img11.webp", name: "Women Regular Fit Solid Spread Collar Casual Shirt", price:399},
        { image:"women/img12.webp", name: "Embroidered Semi Stitched Lehenga Choli (Purple)", price:1599},
        { image:"women/img13.webp", name: "Embellished, Self Design Semi Stitched Lehenga Choli (Pink)", price:1299},
        { image:"women/img14.webp", name: "Embroidered Semi Stitched Lehenga Choli (Maroon)", price:1999},
        { image:"women/img15.webp", name: "Embroidered Semi Stitched Lehenga Choli (Maroon)", price:199},
        { image:"women/img16.webp", name: "Women Colorblock Round Neck Cotton Blend White, Black T-Shirt", price:500}
    ],

    kids: [
        { image:"kids/img1.webp", name: "Girls Below Knee Casual Dress (Purple, 3/4 Sleeve)", price:499},
        { image:"kids/img2.webp", name: "Girls Midi/Knee Length Party Dress (Blue, Full Sleeve)", price:700},
        { image:"kids/img3.webp", name: "Girls Above Knee Casual Dress (Red, Sleeveless)", price:600},
        { image:"kids/img4.webp", name: "Baby Boys & Baby Girls Casual T-shirt Pant (Pink)", price:300},
        { image:"kids/img5.webp", name: "Full Length Party Dress (Black, Full Sleeve)", price:799},
        { image:"kids/img6.webp", name: "ECOM FASHION HUB Spiderman Kids Costume Wear", price:500},
        { image:"kids/img7.webp", name: "Boys Party(Festive) Blazer Pyjama (Yellow)", price:999},
        { image:"kids/img8.webp", name: "Boys Casual T-shirt Track Pants (Light Blue)", price:399},
        { image:"kids/img9.webp", name: "Baby Boys Casual T-shirt Pant (Multicolor)", price:599},
        { image:"kids/img10.webp", name: "Boys Regular Fit Printed Spread Collar Casual Shirt", price:800},
        { image:"kids/img11.webp", name: "Boys Festive & Party Shirt & Dhoti Set (Gold)", price:999},
        { image:"kids/img12.webp", name: "Girls Below Knee Casual Dress (Purple, Short Sleeve)", price:1200},
        { image:"kids/img13.webp", name: "Raj Costume Krishna Dress for Kids 1 Year Baby Boy 6-12 Months", price:1500},
        { image:"kids/img14.webp", name: "Girls Festive & Party Kurta and Pyjama Set (Dark)", price:1000},
        { image:"kids/img15.webp", name: "Girls Festive & Party Kurta, Pyjama & Dupatta Set (Purple)", price:1500},
        { image:"kids/img16.webp", name: "Boys Printed Pure Cotton Oversized T Shirt (Black)", price:200}
    ],

    new: [
        { image:"new/img1.webp", name: "Women Maxi Dark Blue, Light Blue Dress", price:469},
        { image:"new/img2.webp", name: "Boys 5 Piece Coat Suit Set Solid Suit", price:2649},
        { image:"new/img3.webp", name: "Men 2 PC Suit Solid Suit", price:3959},
        { image:"new/img4.webp", name: "Printed Hand Batik Cotton Silk Saree (Orange)", price:619},
        { image:"new/img5.webp", name: "Men Printed Round Neck Cotton Blend Red T-Shirt", price:350},
        { image:"new/img6.webp", name: "Baby Girls Maxi/Full Length Festive/Wedding Dress (Blue)", price:399},
        { image:"new/img7.webp", name: "Boys Festive & Party, Wedding Dhoti & Kurta Set (Red)", price:699},
        { image:"new/img8.webp", name: "Girls Midi/Knee Length Casual Dress (Black, 3/4 Sleeve)", price:899},
        { image:"new/img9.webp", name: "Boys Festive & Party Kurta and Pyjama Set (Maroon)", price:799},
        { image:"new/img10.webp", name: "Men Single Breasted - 2 button Checkered Suit", price:1299},
        { image:"new/img11.webp", name: "Printed Semi Stitched Lehenga Choli  (Light Blue)", price:450},
        { image:"new/img12.webp", name: "Men Slim Fit Solid Spread Collar Casual Shirt", price:679},
        { image:"new/img13.webp", name: "Girls Party Rayon A-line Top (Dark Green, Pack of 1)", price:600},
        { image:"new/img14.webp", name: "Boys Festive & Party Kurta, Waistcoat and Pyjama Set (Light Blue)", price:1000},
        { image:"new/img15.webp", name: "Men Boxy Fit Solid Spread Collar Casual Shirt", price:450},
        { image:"new/img16.webp", name: "Women 2 Pc Coat Set (Blazer&Pant) Solid Suit", price:749}
    ]
};

let cart = JSON.parse(localStorage.getItem('cart')) || [];
const promoCode = "DISCOUNT10"; // Example promo code for Discount 10% 

function renderProducts(category) {
    const container = document.getElementById(`${category}-products`);
    container.innerHTML = '';
    products[category].forEach((product, index) => {
        const productElement = document.createElement('div');
        productElement.classList.add('product');
        productElement.innerHTML = `
            <img src="${product.image}" alt="${product.name}">
            <p>${product.name}</p>
            <p>&#8377;${product.price}</p>
            <button onclick="addToCart('${category}', ${index})">Add to Cart</button>
        `;
        container.appendChild(productElement);
    });
}

function addToCart(category, index) {
    const product = products[category][index];
    // Check if the product is already in the cart
    const existingProductIndex = cart.findIndex(item => item.name === product.name);
    if (existingProductIndex !== -1) {
        // Increment the quantity of the existing product
        cart[existingProductIndex].quantity += 1;
    } else {
        // Add products to cart
        cart.push({
            image: product.image,
            name: product.name,
            price: product.price,
            quantity: 1
        });
    }
    localStorage.setItem('cart', JSON.stringify(cart));
    document.getElementById('cart-count').innerText = cart.length;
    if (window.location.pathname.includes('cart.html')) {
        updateCart();
    }
}

function updateCart() {
    const cartItems = document.getElementById('cart-items');
    cartItems.innerHTML = '';

    // Create table element
    const table = document.createElement('table');
    table.classList.add('cart-table');

    // Create table header
    const header = document.createElement('thead');
    header.innerHTML = `
        <tr>
            <th>Product</th>
            <th>Product Name</th>
            <th>Price</th>
            <th>Quantity</th>
            <th>Total</th>
            <th>Action</th>
        </tr>
    `;
    table.appendChild(header);

    // Create table body
    const tbody = document.createElement('tbody');
    let grandTotal = 0;
    cart.forEach((item, index) => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td><img src="${item.image}" alt="${item.name}" style="width: 50px; height: 50px;"></td>
            <td>${item.name}</td>
            <td>&#8377;${item.price}</td>
            <td>
                <button class="change" onclick="decrementQuantity(${index})">-</button>
                ${item.quantity}
                <button class="change" onclick="incrementQuantity(${index})">+</button>
            </td>
            <td>&#8377;${(item.price * item.quantity).toFixed(2)}</td>
            <td><a class="action" onclick="removeFromCart(${index})">Remove</a></td>
        `;
        tbody.appendChild(row);
        grandTotal += item.price * item.quantity;
        
    });
    table.appendChild(tbody);

    // Append the table to the cart items container
    cartItems.appendChild(table);

    // Update total price
    document.getElementById('total-price').innerText = grandTotal.toFixed(2);
}

function removeFromCart(index) {
    // Remove item from cart array
    cart.splice(index, 1);
    // Update localStorage with the new cart data
    localStorage.setItem('cart', JSON.stringify(cart));
    const cartCountElements = document.querySelectorAll('#cart-count');
    cartCountElements.forEach(element => element.innerText = cart.length);
    if (window.location.pathname.includes('cart.html')) {
        updateCart();
    }
}

function incrementQuantity(index) {
    cart[index].quantity += 1;
    localStorage.setItem('cart', JSON.stringify(cart));
    updateCart();
}

function decrementQuantity(index) {
    if (cart[index].quantity > 1) {
        cart[index].quantity -= 1;
    } else {
        removeFromCart(index);
        return; 
    }
    localStorage.setItem('cart', JSON.stringify(cart));
    updateCart();
}

function applyPromoCode() {
    const input = document.getElementById('promo-input').value;
    const total = parseFloat(document.getElementById('total-price').innerText);
    if (input === promoCode) {
        const discount = total * 0.10;  //10% discount
        document.getElementById('total-price').innerText = (total - discount).toFixed(2);
    } else {
        alert('Invalid promo code');
    }
}

function checkout() {
    alert('Checkout feature not implemented.');
}

// Initialize cart count
if (document.getElementById('cart-count')) {
    document.getElementById('cart-count').innerText = cart.length;
}


